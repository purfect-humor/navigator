<!DOCTYPE html>
<html>
    <head>
        <title>My page</title>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-mobile/1.4.5/jquery.mobile.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/snap.js/1.9.3/snap.min.css">
        <style>
        #map-page, #map-canvas { width: 100%; height: 100%; padding: 0; }
        #map-page { z-index: 1; }
        </style>
    </head>
    <body>
        <div class="snap-drawers">
          <div class="snap-drawer snap-drawer-left">
            <div>
              <h3>Snap.js</h3>
              <div class="demo-social">
                <a href="https://twitter.com/share" class="twitter-share-button" data-lang="en" data-text="Snap.js - A Library for creating beautiful mobile shelfs in Javascript" data-url="http://jakiestfu.github.com/Snap.js/" data-count="none" data-via="jakiestfu">Tweet</a>
                <a href="https://twitter.com/jakiestfu" class="twitter-follow-button" data-show-count="false" data-lang="en">Follow @jakiestfu</a>
                <iframe src="http://ghbtns.com/github-btn.html?user=jakiestfu&amp;repo=Snap.js&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="120" height="20"></iframe>
              </div>
              <h4>Demos</h4>
              <ul>
                <li><a href="default.html">Default</a></li>
                <li><a href="noDrag.html">No Drag</a></li>
                <li><a href="dragElement.html">Drag Element</a></li>
                <li><a href="rightDisabled.html">Right Disabled</a></li>
                <li><a href="hyperextend.html">Hyperextension Disabled</a></li>
                <li><a href="skinnyThreshold.html">Skinny Threshold</a></li>
                <li><a href="toggles.html">Toggles</a></li>
                <li><a href="classNames.html">Class Names</a></li>
                <li><a href="expand.html">Expanding</a></li>
                <li><a href="settings.html">Settings</a></li>
                <li><a href="ratchet/template.html">Ratchet</a></li>
              </ul>
              <div>
                <p>The Default demo shows basic Snap.js functionality</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla non erat ac leo ultrices blandit sed vel risus. Pellentesque facilisis blandit auctor. Maecenas vestibulum vulputate tincidunt. Mauris nec quam libero. Fusce eget ligula non leo varius condimentum quis ac elit. Donec id urna ut neque semper ultrices. Proin ut suscipit felis. Nullam neque felis, ullamcorper scelerisque volutpat vel, vehicula vehicula neque. Aenean scelerisque elit ac erat sagittis ullamcorper.</p>
              </div>
            </div>
          </div>
          <div class="snap-drawer snap-drawer-right"></div>
        </div>

        <div data-role="page" id="map-page">
          <div data-role="header">
            <a href="#" id="sidebar-btn" class="ui-btn ui-icon-bars ui-btn-icon-notext ui-corner-all"></a>
            <h1>Insert Page Title Here</h1>
          </div>

          <div data-role="main" class="ui-content" id="map-canvas">
            
          </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-mobile/1.4.5/jquery.mobile.min.js"></script>
        <script src="https://maps.google.com/maps/api/js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/snap.js/1.9.3/snap.min.js"></script>
        <script>
        var snapper = new Snap({
          element: document.getElementById('map-page'),
          disable: 'right',
          touchToDrag: false
        });

        document.getElementById('sidebar-btn').addEventListener('click', function() {
          if( snapper.state().state=="left" ){
            snapper.close();
          } else {
            snapper.open('left');
          }
        }, false);
        
        /*
         * Google Maps documentation: http://code.google.com/apis/maps/documentation/javascript/basics.html
         * Geolocation documentation: http://dev.w3.org/geo/api/spec-source.html
         */
        $( document ).on( "pagecreate", "#map-page", function() {
            var defaultLatLng = new google.maps.LatLng(34.0983425, -118.3267434);  // Default to Hollywood, CA when no geolocation support
            if ( navigator.geolocation ) {
                function success(pos) {
                    // Location found, show map with these coordinates
                    drawMap(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude));
                }
                function fail(error) {
                    drawMap(defaultLatLng);  // Failed to find location, show default map
                }
                // Find the users current position.  Cache the location for 5 minutes, timeout after 6 seconds
                navigator.geolocation.getCurrentPosition(success, fail, {maximumAge: 500000, enableHighAccuracy:true, timeout: 6000});
            } else {
                drawMap(defaultLatLng);  // No geolocation support, show default map
            }
            function drawMap(latlng) {
                var myOptions = {
                    zoom: 10,
                    center: latlng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);
                // Add an overlay to the map of current lat/lng
                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map,
                    title: "Greetings!"
                });

                var pos = new google.maps.LatLng("{{ stat.latitude }}", "{{ stat.longitude }}");
                var marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    title: "{{ stat.name }}"
                });
            }
        });
        </script>
    </body>
</html>
